

%  article.tex (Version 3.3, released 19 January 2008)
%  Article to demonstrate format for SPIE Proceedings
%  Special instructions are included in this file after the
%  symbol %>>>>
%  Numerous commands are commented out, but included to show how
%  to effect various options, e.g., to print page numbers, etc.
%  This LaTeX source file is composed for LaTeX2e.

%  The following commands have been added in the SPIE class 
%  file (spie.cls) and will not be understood in other classes:
%  \supit{}, \authorinfo{}, \skiplinehalf, \keywords{}
%  The bibliography style file is called spiebib.bst, 
%  which replaces the standard style unstr.bst.  

\documentclass[a4paper]{spie}  %>>> use for US letter paper
%%\documentclass[a4paper]{spie}  %>>> use this instead for A4 paper
%%\documentclass[nocompress]{spie}  %>>> to avoid compression of citations
%% \addtolength{\voffset}{9mm}   %>>> moves text field down
%% \renewcommand{\baselinestretch}{1.65}   %>>> 1.65 for double spacing, 1.25 for 1.5 spacing 
%  The following command loads a graphics package to include images 
%  in the document. It may be necessary to specify a DVI driver option,
%\textit{}%  e.g., [dvips], but that may be inappropriate for some LaTeX 
%  installations. 
\usepackage{amsmath}
\usepackage[]{graphicx}
\usepackage{hyperref}
\usepackage{listings}
\hypersetup{
    colorlinks,
    linkcolor={black!50!black},
    citecolor={blue!50!black},
    urlcolor={blue!80!black}
}
\usepackage{pdfpages}
\usepackage{parcolumns}

\usepackage[utf8]{inputenc} 
\usepackage[ngerman]{babel}
\usepackage[autostyle=true,german=quotes]{csquotes}

\usepackage{color}
\definecolor{lightgray}{rgb}{.9,.9,.9}
\definecolor{darkgray}{rgb}{.4,.4,.4}
\definecolor{purple}{rgb}{0.65, 0.12, 0.82}


\usepackage{array}
\newcolumntype{L}[1]{>{\raggedright\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\newcolumntype{C}[1]{>{\centering\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\newcolumntype{R}[1]{>{\raggedleft\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}

\usepackage{xcolor,colortbl}
\usepackage{color}
\usepackage{float}
\definecolor{lightgray}{rgb}{.9,.9,.9}
\definecolor{darkgray}{rgb}{.4,.4,.4}
\definecolor{purple}{rgb}{0.65, 0.12, 0.82}

\lstdefinelanguage{JavaScript}{
  keywords={typeof, new, true, false, catch, function, return, null, catch, switch, var, if, in, while, do, else, case, break},
  keywordstyle=\color{blue}\bfseries,
  ndkeywords={class, export, boolean, throw, implements, import, this},
  ndkeywordstyle=\color{darkgray}\bfseries,
  identifierstyle=\color{black},
  sensitive=false,
  comment=[l]{//},
  morecomment=[s]{/*}{*/},
  commentstyle=\color{purple}\ttfamily,
  stringstyle=\color{red}\ttfamily,
  morestring=[b]',
  morestring=[b]"
}

\lstset{
   language=JavaScript,
   backgroundcolor=\color{lightgray},
   extendedchars=true,
   basicstyle=\footnotesize\ttfamily,
   showstringspaces=false,
   showspaces=false,
   numbers=left,
   numberstyle=\footnotesize,
   numbersep=9pt,
   tabsize=2,
   breaklines=true,
   showtabs=false,
   captionpos=b
}

\title{Mobiledevice controllerAPI} %% TODO: Chris, Hannes, Micha, Dennis, Ron
%% TODO: Chris Untertitel
%>>>> The author is responsible for formatting the 
%  author list and their institutions.  Use  \skiplinehalf 
%  to separate author list from addresses and between each address.
%  The correspondence between each author and his/her address
%  can be indicated with a superscript in italics, 
%  which is easily obtained with \supit{}.

\author{ Ron Schiwkowksi  (918691), Hannes Grothknopf (915449), Michael Schleiss (923739)), Dennis Hofmann (919285), Christian Heinrichs (919020
\skiplinehalf
University of Applied Sciences, Sokratesplatz 1, 24149 Kiel, Germany
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%>>>> uncomment following for page numbers
\pagestyle{plain}    
%>>>> uncomment following to start page numbering at 301 
%\setcounter{page}{301} 
 
  \begin{document} 
  \maketitle 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
\begin{abstract} %% TODO: Micha
Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.
\end{abstract}

%>>>> Include a list of keywords after the abstract 
\keywords{Mobile, Smartphone, JavaScript, HTML5, Nodejs, API}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Einleitung} %% TODO: Hannes
Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam.

\subsection{Problemstellung}
Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam.
\begin{figure}[h!]
	\centering
		\fbox{\includegraphics[width=12cm]{./images/FrontendInit.png}}
		\caption{Nicht ausgelastet Bar}
		\label{fig:FrontendInit}
\end{figure}

Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.(siehe Abbildung \ref{fig:FrontendInit}).
\\
Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam.

\section{Methodik} %% TODO: Chris
\subsection{Projektmanagement}
Das Team besteht aus 5 Projektmitgliedern. Die Verteilung der Aufgaben ist in Tabelle \ref{table:Aufgabenverteilung} aufgestellt.
Verschiedene Aufgaben sind im Gitlab erfasst und Personen zugewiesen. Ein wöchentliches persönliches Treffen aller Projektmitglieder führt zu einer guten Arbeitsmoral und hohen Effektivität.
\subsubsection{GitLab}
Das Projekt wurde auf einem eigenen GitLab gehostet und den Projektmitgliedern zur Verfügung gestellt. Die Issues des Systems wurden genutzt um Aufgaben zu verteilen und zu dokumentieren.
\\
Strukuriert wurde das Arbeiten nach Feature Branches, um das Arbeiten am Projekt möglichst flexibel zu halten. Der Master-Branch diente als Release-Branch, in den regelmäßig die Änderungen per Merge Request eingetragen und getestet wurden.
\definecolor{blau}{HTML}{217AA2}
\begin{table}
	\label{table:Aufgabenverteilung}
	\centering
		\caption{Matrix der Aufgabenverteilung}
		\begin{tabular}{| L{2.6cm} | C{2cm} | C{2cm} | C{2cm} | C{2cm} | C{2cm} |}
		\hline
		\rowcolor{blau}
		\textcolor{white}{\textbf{Aufgabe}} & \textcolor{white}{\textbf{Schleiss}} & \textcolor{white}{\textbf{Grothknopf}} & \textcolor{white}{\textbf{Schiwkowksi}} & \textcolor{white}{\textbf{Hofmann}} & \textcolor{white}{\textbf{Heinrichs}}\\\hline
		Recherche 		& X & X	& X	& X	& X	\\\hline
		Konzept 		& X & X	& X	& X	& X	\\\hline
		Serverdesign	& 	& X & 	& 	& X \\\hline
		Networking		& 	& X	& 	& X	& X	\\\hline
		GameAPI 		& 	& X	&	&	& X	\\\hline
		DemoGame 		& X	&	&	&	& X	\\\hline
		ClientFrontend 	& X	&	& X	&	&	\\\hline
		ClientBackend 	& X	&	& X	&	&	\\\hline
		Database 	    & 	&	&	& X	& 	\\\hline
		Poster          & 	& 	& 	& 	& 	\\\hline
		Documentation   & 	& 	& 	& 	& X \\\hline
		Projektmgmt. 	&	&	&	& 	& X	\\\hline
	\end{tabular}
\end{table}

\subsection{Technologien} %% TODO: Dennis
\subsubsection{NodeJS}
\hfill
\begin{figure}
\begin{minipage}[t]{0.5\textwidth}

\vspace{0pt}
		\includegraphics[width=\textwidth]{./images/software/1436439824nodejs-logo}
		\caption{Aufbau 2. Test Störungsfreier Raum}
		\label{fig:test2}
\end{minipage}
\end{figure}
Was ist NodeJS, Warum genutzt
\begin{figure}[h!]
	\centering
		\fbox{\includegraphics[width=12cm]{./images/FrontendInit.png}}
		\caption{Systemarchitektur WiFi Tracking}
		\label{fig:sysArch}
\end{figure}

Die Berechnung der Signalstärke wird nicht durch Kismet vorgenommen, sondern geschieht intern in der jeweiligen Netzwerkkarte. Es wird bei den Raspberry Pi ein LOGILINK WL0084B WiFi-USB-Stick verwendet. Die Dämpfung kann bei verschieden Netzwerkkarten stark abweichen. Deshalb ist es erforderlich, dass im Versuchsaufbau nur gleiche Netzwerkkarten verwendet werden.

\subsubsection{HTML 5}
Was kann HTML5, was nutzen wir für HTML 5 Features
\begin{figure}[h!]
	\centering
		\fbox{\includegraphics[width=10cm]{./images/FrontendInit.png}}
		\caption{Virtuelle Maschinen vs. Docker Container\cite{dockercontainer}}
		\label{fig:dockerVM}
\end{figure}

\subsubsection{Javascript}
Was kann Javascript, ECMA 6
\begin{figure}[h!]
	\centering
		\fbox{\includegraphics[width=10cm]{./images/FrontendInit.png}}
		\caption{Virtuelle Maschinen vs. Docker Container\cite{dockercontainer}}
		\label{fig:dockerVM}
\end{figure}
\subsubsection{JS-Libraries}
\paragraph{jquery.js}
\paragraph{require.js}
\paragraph{socket.io}
\begin{figure}[h!]
	\centering
		\fbox{\includegraphics[width=10cm]{./images/FrontendInit.png}}
		\caption{Virtuelle Maschinen vs. Docker Container\cite{dockercontainer}}
		\label{fig:dockerVM}
\end{figure}
\subsubsection{MongoDB}
Was kann MongoDB, Warum MongoDB
\begin{figure}[h!]
	\centering
		\fbox{\includegraphics[width=10cm]{./images/FrontendInit.png}}
		\caption{Virtuelle Maschinen vs. Docker Container\cite{dockercontainer}}
		\label{fig:dockerVM}
\end{figure}
\subsubsection{Hardware}
Smartphone Controller, Platformunabhängig Node Server

%
% -----------------Implementierung-------------------------
%

\section{Implementierung}


\subsection{Architektur}

\begin{figure}
	\centering
		\fbox{\includegraphics[width=15cm]{./images/arch/M113.png}}
		\caption{Virtuelle Maschinen vs. Docker Container\cite{dockercontainer}}
		\label{fig:dockerVM}
\end{figure}
\subsection{User Management} %% TODO: Dennis
Das "UserManagement" kümmert sich um die Verwaltung der Nutzer. Dafür stellt es Funktionen für die Registrierung, Authentifizierung sowie für das setzen und holen von Benutzerdaten zur Verfügung. Die Funktionen im "UserManagement" bekommen eine callback Funktion übergeben, welche bei einer erfolgreichen Ausführung ausgeführt wird.

\subsection{Datenbank} %% TODO: Dennis
Das "Database" Modul kümmert sich um die Persistente Speicherung aller anfallenden Daten. Dafür wird eine MongoDB verwendete und die für das hinzufügen, löschen, updaten und für Abfragen benötigten Funktionen zur Verfügung gestellt.

\subsection{Network}
Die Netzwerkverbindungen bilden einen wichtigen Bestandteil der Anwendung. Alle Clients und das Server-Frontend bzw. Spiel verbinden sich zum Server via WebSocket.

\subsubsection{socket.io}
Zum Aufbau und Handling der Netzwerkverbindungen wird die Bibliothek socket.io von Guillermo Rauch verwendet. Sie kapselt die WebSocket API Spezifikationen und bietet eine vereinfachte und einfach zu benutzende API zu den WebSockets auf Client und Server-Seite. Außerdem verfügt sie über Failover-Strategien, die das Verwenden von anderen Protokollen vorsehen, für den Fall, dass WebSockets vom Client oder Server nicht unterstützt werden.
Auf node Server Seite werden die Pakete 'http' und 'socket.io' benötigt. Erstes um einen HTTP-Server zu erstellen und letzteres, um diesen dann zu einer WebSocket Verbindung aufzuwerten und diese dann zu verwalten. Grundlegen wird die Verbindung mit Hilfe von message Events implementiert, welche auf dem jeweiligen Socket ausgelöst und abgehört werden können. Dieses Prinzip ähnelt stark den von node bekannten Events. Eine Client-Version von socket.io wird vom Server automatisch veröffentlich und kann so auf dem Client direkt eingebunden und verwendet werden.
\url{https://davidwalsh.name/websocket}

\subsubsection{Server Network handling}
Die Anwendung besteht aus einem zentralen node Server, einem Frontend zur Darstellung des Spiels und eine unbestimmte Anzahl an mobilen Clients. Alle Komponenten stellen jeweils eine Websocket Verbindung zum Server her, dem so jeden Client bekannt ist und er diese verwalten kann. Durch die Verwendung der selbst geschriebenen Module 'gameApi' und 'clientNetwork' werden die Funktionen der Websockets erneut gekapselt und ermöglichen eine sehr einfaches Aufbauen der Verbindung und Verwendung der anwendungs-spezifischen Befehle.
Der Server hält zu jeder Zeit eine Liste aller offenen Socket-Verbindungen, die es ermöglich individuell mit jedem Client und dem Frontend zu kommunizieren. Eingehende Nachrichten können so direkt einem Absender zugeordnet werden, ohne dass dieser seine Identität oder IP-Adresse mitsenden muss.
Auf diesem Level der Kommunikation wurden grundlegende Socket-Events zum Verbindungsaufbau, der Nutzerverwaltung (Registration und Login) sowie dem Verschicken der eigentlichen Nachrichten. Abhängig vom Typ der eingehenden Nachricht werden die Funktionen der nächst-höheren Programmschicht aufgerufen, die diese dem Netzwerk Modul bei der Initialisierung per Callback übergeben hat. Die eigentlichen Socket-Events werden an dieser Stelle nicht weitergegeben, um die technische Socket-Logik komplett im Modul zu kapseln. Die Struktur der einzelnen Nachrichtentypen wurde genau definiert. Besonders im Fall der tatsächlichen Nachtrichten Pakete wurde ein weiteres 'type' Attribut eingefügt, die es dem Spieleentwickler erlaubt unabhängig von den Socket Event Typen eigene Nachrichten-Typen zu definieren, die zwischen Kontroller und Spiel ausgetauscht werden.
Ein weiterer wichtiger Aspekt ist die Art und Weise in der die Socket auf Client-Seite aufgebaut werden. Da JavaScript keine echte Persistenz von Variable und Objekten über den Scope einer HTML-Seite erlaubt, wird jede bestehende Socket-Verbindung abgebrochen sobald die Seite neu oder eine andere geladen wird. Da die Kontroller-Clients ihre Funktionalität jedoch auf eine Oberfläche begrenzen stellt dies kein gravierendes Problem dar.
Zusätzlich bietet das 'serverNetwork' Modul eine Reihe an Funktionen an, mit den Clients und dem Frontend zu kommunizieren und diese zu verwalten. Die meisten dieser Funktion setzen das Adressieren des gewünschten Clients über dessen Socket ID voraus.
\url{http://stackoverflow.com/questions/7709289/how-to-pass-javascript-object-from-one-page-to-other}
\url{http://tavendo.com/blog/post/websocket-persistent-connections/}

\subsection{Session}
Die nächste Schicht nach dem Netzwerk stellt auf Server-Seite das Modul 'sessionHandling' dar. Hier werden die noch anonymen Socket-Verbindungen bzw. deren IDs mit tatsächlichen Nutzernamen und der zugrundeliegenden Nutzerverwaltung verknüpft. Dies bedeutet zunächst, dass jeder Client sich zum Benutzen der Anwendung am Server authentifizieren muss. Jede eingehende Login-Anfrage wird da das Modul 'UserManagement' weitergeleitet um die übergebenden Nutzerdaten zu verifizieren. Nach einem erfolgreichen Login werden die Daten des Nutzers in eine Liste aktiver Nutzer gespeichert und sein Nutzername wird an die nächste Schicht weiter gegeben. Alle weiteren Anfragen werden solange abgewiesen, bis sich ein Nutzer authentifiziert hat. Beim Disconnet eines Nutzers wird sein Eintrag aus der Liste gelöscht und es wird ebenfalls eine Nachricht an die nächste Programm-Schicht übergeben. Alle Nachrichten, die tatsächliche Kommunikationsdaten zwischen Clients und dem Spiel beinhalten werden direkt weitergegeben.
Ein Login bedeutet notwendigerweise eine zuvor erfolgte Registrierung, welche ebenfalls vom 'UserManagement' Modul verwaltet wird. Um die Registrierung jedoch nicht zu einer unnötigen Barriere in der Verwendung der Applikation zu machen, ist es ebenfalls möglich sich anonym einzuloggen. In diesem Fall wird der jeweiligen Socket-Verbindung ein zufälliger Nutzername zugewiesen. Der Vorteil eines Nutzerkontos bietet die Möglichkeit für das Spiel, weitere Daten für einen Nutzer Session übergreifend zu speichern.
Wie zuvor bereits angesprochen wurde, können die Socket-Verbindungen nicht über mehrere Seitenaufrufe auf dem Client bestehen bleiben. Dies bedeutet für die Login-Session, dass diese direkt an die bestehende Socket-Verbindung gekoppelt ist und beendet wird, sobald der Socket geschlossen wird.

\subsection{User management}
?
\subsection{Smartphone Frontend}
\paragraph{Template} %% TODO: Ron
\paragraph{Client-JS} %% TODO: Ron

\subsection{Beschreibung der GameAPI} %% TODO Micha
Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam.


\section{Demonstration} %% TODO: Chris
\subsection{Vorbereitung}
\begin{enumerate}
 \item Ein Computer stellt den NodeJS Server.
 \item Ein weiterer Computer stellt das gewählte Demogame-Frontend auf einem großen Bildschirm dar.
 \item Mehrere Clients verbinden sich mit ihren mobilen Geräten auf den Server.
\end{enumerate}
Anschließend müssen die vom NodeJS Server benötigten Abhgängikeiten installiert werden. Dies geschieht mit einen Skriptaufruf, wie in Listing \ref{lst:installDeps} beschrieben.
\lstset{
  numbers=left,
  stepnumber=5,
  firstnumber=1,
  numberfirstline=true
}
\begin{figure}[h!]
	\centering
        \begin{lstlisting}[language=bash,caption={Installieren der Abhängigkeitenn},label={lst:installDeps}]
           bash prepareDeps.sh
        \end{lstlisting}
\end{figure}
\subsection{Start der Applikation}
Der NodeJS Server wird mit dem Befehl wie in Listing \ref{lst:launch} gestartet. Imfolgenden sollte eine Meldung erscheinen welche den Applikationsserver als gestartet meldet. Eine Beispielhafte Meldung in in Listing \ref{lst:launchSuccess} zu sehen.

\begin{figure}[h!]
	\centering
        \begin{lstlisting}[language=JavaScript,caption={Start der Applikation},label={lst:launch}]
           node NodeServer/bin/www
        \end{lstlisting}
\end{figure}
\begin{figure}[h!]
	\centering
        \begin{lstlisting}[language=JavaScript,caption={Start der Applikation},label={lst:launchSuccess}]
           16 Jan 14:39:22 serverNetwork | Server listening on port 5222
        \end{lstlisting}
\end{figure}
\subsection{Durchführung}
Die Clients rufen die Adresse des Servers auf und es wird ihnen eine Login Anzeige dargestellt. Hier wird nun eine Entscheidung getroffen, ob ein Login erstellt, genutzt oder anonym weiter forgefahren werden soll.
Wird ein Login genutzt, wird anstelle eines generierten Namens der tatsächliche Benutzername im gewählten Demogame angezeigt. \\
Die nun verbundenen Clients führen mit ihren Geräten unterschiedliche Aktionen durch. Ein Druck auf einen der Buttons auf einem der Clientgeräte wird als solcher identifiziert und im Frontend dargestellt. Ein anderer Cleint aktivert die Rotationserfassung und die gesendeten Daten erscheinen auf dem Fronend.

\subsection{Lasttestmessung}\label{Lasttestmessung} %% TODO: Dennis
Zeitstempel Problem
\begin{figure}[H]
\vspace{0pt}
\paragraph{Aufbau}
Der Versuchsaufbau wurde in direkter Nähe des WLAN Hotspots erstellt, um eine möglichst ideale Signalstärke zu erreichen. Der Versuchsaufbau besteht
\hfill
\vspace{0pt}

\subsection{Durchführung}\mbox{}\\
\paragraph{Ablauf der Messung}\mbox{}\\
Anschließend wurde die in Abbildung \ref{fig:probeMessung} zur erkennende Strecke mit einem Smartphone abgelaufen. Beim Abgehen der Strecke wurde nach circa jedem Meter eine kurze Zeit verweilt, damit ein aussagekräftigeres Ergebnis erzielt werden konnte.

\paragraph{Ergebisse}\mbox{}\\

\centering
		\includegraphics[width=15cm]{./images/LasttestDiagramm.png}
		\caption{Probemessung}
		\label{fig:probeMessung}
\end{figure}

Auf Abbildung \ref{fig:test1} ist zu sehen von welcher Drohne sich das Gerät entfernt und welcher es sich nähert.\\

\begin{figure}[H]
\begin{minipage}[t]{0.4\textwidth}
\vspace{0pt}
\includegraphics[height=5cm]{./images/FrontendInit.png}
\caption{Berechnungen zum Ergebnis}
\label{fig:tablleMessung}
\end{minipage}
\hfill
\begin{minipage}[t]{0.5\textwidth}
\vspace{0pt}
		\includegraphics[width=\textwidth]{./images/FrontendInit.png}
		\caption{Ergebnis der Probemessung}
		\label{fig:test1}
\end{minipage}
\end{figure}

\subsection{Limitations}
\subsubsection{1. Test}

\paragraph{Ergebnis}\mbox{}\\
Selbst auf kurzer Distanz ist eine Differenz von ca. 10 dBm zwischen den Messpunkten zu sehen. Dies ermöglicht eine Ortsbestimmung auf kurzer Distanz, was beim nächsten Test ebenfalls zu sehen ist.

\begin{table}[H]
\centering
	\begin{tabular}{ | p{2.5cm} | l | l | l | }
		\hline 
		Entfernung	& 50 cm	& 100 cm	& 200 cm	\\ \hline
		Durchschnittliche Dämpfung & -62,22 dBm	& -75,45 dBm	& -82,52 dBm \\
		\hline
	\end{tabular}
	\caption{Ergebnisse des 1. Tests im störungsfreien Raum}
	\label{tab:probeTab}
\end{table}

\subsubsection{2. Test}\label{testNr2}

\begin{figure}[H]
\begin{minipage}[t]{0.4\textwidth}
\vspace{0pt}
\paragraph{Aufbau}\mbox{}\\
Um zu ermitteln, wie genau der Vergleich von Dämpfungswerten für die Positionsermittlung benutzt werden kann, wurden zwei Kismet-Drohnen in 12 Meter Abstand voneinander aufgestellt. Diese waren über einen Switch mit dem Kismet-Server verbunden. Alle 120 cm wurde ein Messpunkt festgelegt. Dies entsprach der Größe einer Bodenplatte im störungsfreien Raum und wurde deshalb als Distanz gewählt.
\end{minipage}
\hfill
\begin{minipage}[t]{0.5\textwidth}
\vspace{0pt}
		\includegraphics[width=\textwidth]{./images/FrontendInit.png}
		\caption{Aufbau 2. Test Störungsfreier Raum}
		\label{fig:test2}
\end{minipage}
\end{figure}

\paragraph{Ablauf der Messung}\mbox{}\\
Ein Smartphone wurde auf den entsprechenden Messpunkt gelegt. WiFi war auf dem Gerät eingeschaltet und die App zur Traffic-Generierung war aktiv. Es wurden pro Messpunkt circa 100 Messwerte aufgenommen, damit eine aussagekräftiges Ergebnis erzielt werden konnte und kurzzeitige Störungen abgefangen werden konnten.

\paragraph{Ergebnis}\mbox{}\\
Wie schon bei der ersten Probemessung ist eine deutliche Tendenz zu erkennen. Bei der Drohne, von der sich das Smartphone entfernte, nahm die Dämpfung zu. Bei der anderen Drohne nahm sie ab. Die aufgenommen Dämpfungswerte sind bei circa 480 cm gleich groß (siehe Diagramm \ref{fig:480} im Anhang). Dies ist 120 cm von der eigentlichen Mitte entfernt. Somit besteht eine Messungenauigkeit von 120 cm.

\subsection{Realistische Messung}
\paragraph{Aufbau}\mbox{}\\
Der Aufbau der Messung war der gleiche wie in der 2. Messung im störungsfreien Raum (siehe \ref{testNr2}). Dieses mal fand die Messung allerdings in einem einfachen Flur der FH-Kiel statt und war somit nicht vor Störungen geschützt.

\paragraph{Ablauf der Messung}\mbox{}\\
Ein Smartphone wurde an den einzelnen Messpunkten platziert. Das WiFi war auf dem Gerät aktiviert. Allerdings war das Gerät mit keinem WiFi-Netzwerk verbunden um die realen Umstände in einer Discothek nachempfinden zu können. Da von Anfang an festgestellt wurde, dass deutlich weniger Pakete abgefangen wurden, wurde die Dauer der Messung an jedem Messpunkt auf 2 Minuten festgesetzt.

\paragraph{Ergebnis}\mbox{}\\
Zu beobachten war, dass in den 2 Minuten 3-9 Pakete abgefangen wurden. Das macht eine Echtzeit-Bewegungsverfolgung so gut wie unmöglich. Ebenso war die Differenz der gemessenen Dämpfungswerte geringer, was eine Positionierung des Geräts erschwert. Das liegt daran, dass auf dem Flur Strahlen der WiFi-Antenne des Smartphones weniger stark gedämpft wurden.

%%
%%
%%
\section{Ausblick}

\paragraph{QRCode} %% TODO: Micha
    Busstop sinnvoll, gameApi.printQRCode()
\paragraph{Glättung der Sensor Werte}  %% TODO: Dennis
Ein noch zu lösendes Problem ist die Glättung der von den Sensoren kommenden Werte. Je nach Gerät liefern die Sensoren unterschiedlich Stark schwankenden Daten. So feuert ein auf dem Tisch liegendes Gerät permanent Orientierungsdaten, obwohl es nicht bewegt wird. Diese Schwankungen müssen erkannt und unterbunden werden. Einbauen eines thresholds.

\paragraph{Disable touch zoom auf dem Client Gerät} %% TODO: Dennis
Beim wiederholten Klicken auf die Buttons der Client-Seite auf den Geräten wird unter Umständen in die Webseite gezoomt. Dies muss unterbunden werden um ein ungewolltes Verhalten zu unterbinden.

\paragraph{Begrenzung der gesendeten Sensor Daten} %%TODO: Dennis
Um den Server nicht ungleich durch die verschiedenen Geräte zu belasten, muss das Sendeverhalten reglementiert werden. Die optimalen Werte dafür müssen noch durch weitere Leistungstest ermittelt werden.


\section{Conclusion} %% TODO: Chris
Alles super. Die erste Million ist nah!




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% References %%%%%
\bibliographystyle{spiebib}   %>>>> makes bibtex use spiebib.bst
\bibliography{references}   %>>>> bibliography data in report.bib

\newpage
\appendix

\end{document} 
